<form [formGroup]="form">
  <div formArrayName="rules">
    <button
      class="btn btn-secondary btn-sm gradient-right-secondary mb-2"
      type="button"
      (click)="addNewRuleControl()"
    >
      Add Rule
    </button>
    <div *ngFor="let ruleControl of rulesControl.controls; let i = index">
      <div class="p-4 mb-4 border border-gray-dark rounded" [formGroupName]="i">
        <div class="grid grid-cols-4 grid-rows-2 gap-4">
          <nartc-settings-input
            id="tag"
            label="Tag*"
            placeholder="Unique tag"
            [control]="$any(ruleControl.get('tag'))"
          ></nartc-settings-input>
          <nartc-settings-input
            id="label"
            label="Label"
            placeholder="Chart label"
            [control]="$any(ruleControl.get('label'))"
          ></nartc-settings-input>
          <nartc-settings-input
            id="color"
            label="Color"
            placeholder="Chart color (hex string)"
            [control]="$any(ruleControl.get('color'))"
          ></nartc-settings-input>
          <nartc-settings-input
            id="marker"
            label="Marker Image URL"
            placeholder="Image URL for map marker"
            [control]="$any(ruleControl.get('marker'))"
          ></nartc-settings-input>
          <nartc-settings-input
            class="col-span-4"
            id="query"
            label="Query*"
            placeholder="Twitter query value"
            [control]="$any(ruleControl.get('query'))"
          ></nartc-settings-input>
        </div>
        <button
          class="btn btn-sm btn-primary gradient-right-primary mt-4"
          type="button"
          (click)="removeRule(ruleControl, i)"
        >
          Remove rule
        </button>
      </div>
    </div>
  </div>
  <div class="flex items-center justify-between">
    <a
      class="link"
      href="https://developer.twitter.com/en/docs/twitter-api/tweets/filtered-stream/integrate/build-a-rule"
      target="_blank"
    >
      Twitter API Documentations - Build Rules
    </a>
    <section>
      <button
        class="btn btn-primary gradient-right-primary"
        type="button"
        [disabled]="isConfirmedDisabled || form.invalid"
        (click)="confirm()"
      >
        Confirm
      </button>
      <button
        class="btn btn-secondary gradient-right-secondary ml-4"
        type="button"
        (click)="cancel()"
      >
        Cancel
      </button>
    </section>
  </div>
</form>
